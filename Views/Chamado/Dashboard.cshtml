@model List<ProjetoTi.Models.Chamado>
@{
    ViewData["Title"] = "Dashboard";
    var usuarioNome = ViewData["UsuarioNome"]?.ToString() ?? "Usuário";
}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>@ViewData["Title"] — SuporteTI IA</title>
  <style>
    :root{
      --bg:#f6f8fb; --card:#ffffff; --muted:#6b7280; --text:#111827;
      --accent:#2563eb; --success:#10b981; --danger:#ef4444;
      --shadow:0 6px 18px rgba(16,24,40,0.06); --radius:12px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:var(--bg);color:var(--text)}
    .app{min-height:100vh;display:grid;grid-template-columns:260px 1fr;gap:24px;padding:28px;transition:all .22s ease}
    /* sidebar */
    .sidebar{background:linear-gradient(180deg,rgba(255,255,255,0.96),var(--card));border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);height:calc(100vh - 56px);display:flex;flex-direction:column;justify-content:space-between}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:44px;height:44px;border-radius:10px;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
    .nav{margin-top:12px;display:flex;flex-direction:column;gap:8px}
    .nav a{display:flex;align-items:center;gap:10px;padding:10px;border-radius:8px;color:var(--text);text-decoration:none}
    .nav a.active{background:rgba(37,99,235,0.12);color:var(--accent)}
    .muted{color:var(--muted);font-size:13px}
    /* main */
    .main{display:flex;flex-direction:column;gap:18px}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .hamburger{display:none;background:transparent;border:0;font-size:20px;cursor:pointer}
    .panel{background:var(--card);border-radius:12px;padding:18px;box-shadow:var(--shadow)}
    /* cards grid */
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;margin-top:14px}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:8px;transition:transform .12s ease, box-shadow .12s ease}
    .card:hover{transform:translateY(-4px)}
    .card h4{margin:0;font-size:16px}
    .badge{display:inline-block;padding:6px 8px;border-radius:999px;font-size:12px}
    .badge.open{background:rgba(34,197,94,0.12);color:var(--success)}
    .badge.pending{background:rgba(250,204,21,0.12);color:#b45309}
    .badge.closed{background:rgba(239,68,68,0.12);color:var(--danger)}
    .btn{background:var(--accent);color:#fff;padding:8px 12px;border-radius:10px;border:0;cursor:pointer;text-decoration:none;display:inline-block}
    .fixed{position:fixed;top:16px;right:16px;padding:10px 14px;border-radius:12px;background:var(--accent);color:#fff;border:0;z-index:120}
    /* responsive (use @@media so Razor doesn't interpret ) */
    @@media (max-width: 900px) {
      .app{grid-template-columns:1fr;padding:16px}
      .sidebar{position:fixed;left:0;top:0;bottom:0;transform:translateX(-110%);transition:transform .25s ease;z-index:60;width:240px}
      .sidebar.open{transform:translateX(0)}
      .hamburger{display:inline-block}
    }
    @@media (max-width: 520px) {
      .grid{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}
      .card h4{font-size:15px}
    }
  </style>
</head>
<body>
  <button class="fixed" onclick="location.href='@Url.Action("Logout","Login")'">🚫 Sair</button>

  <div class="app" id="app">
    <aside class="sidebar" id="sidebar" role="complementary">
      <div>
        <div class="brand">
          <div class="logo">👤</div>
          <div>
            <strong>SuporteTI IA</strong>
            <div class="muted">Painel do Usuário</div>
          </div>
        </div>

        <nav class="nav" aria-label="Menu principal">
          <a href="@Url.Action("Dashboard","Chamado")" class="nav-item active" data-view="recents">📋 Chamados Recentes</a>
          <a href="@Url.Action("Create","Chamado")" class="nav-item" data-view="abrir">✚ Abrir Chamado</a>
          <a href="@Url.Action("Meus","Chamado")" class="nav-item" data-view="meus">🗂️ Meus Chamados</a>
        </nav>
      </div>

      <div class="muted" style="text-align:center">Universidade • Projeto • LGPD</div>
    </aside>

    <main class="main" role="main">
      <header class="topbar">
        <div style="display:flex;align-items:center;gap:12px">
          <button class="hamburger" id="toggleSidebar" aria-label="Abrir menu">☰</button>
          <div>
            <h2>Bem-vindo, @usuarioNome</h2>
            <div class="muted">Painel de suporte e abertura de chamados</div>
          </div>
        </div>
        <div><!-- espaço para ações futuras --></div>
      </header>

      <section class="panel" aria-labelledby="tituloChamados">
        <h3 id="tituloChamados">Chamados Recentes</h3>
        <p class="muted">Últimos chamados abertos por você.</p>

        <div class="grid" id="gridChamados">
          @if(Model != null && Model.Count > 0)
          {
              foreach(var c in Model)
              {
                  <article class="card" aria-labelledby="chamado-@c.Id">
                      <h4 id="chamado-@c.Id">@c.Titulo</h4>
                      <div class="muted">@((c.Descricao?.Length > 150) ? c.Descricao.Substring(0,150) + "…" : c.Descricao)</div>
                      <div><strong>Data:</strong> @c.DataAbertura.ToString("dd/MM/yyyy HH:mm")</div>
                      <div>
                          <span class="badge @(c.Status?.ToLower() == "aberto" ? "open" : c.Status?.ToLower()=="pendente" ? "pending" : "closed")">@c.Status</span>
                      </div>
                      <div style="margin-top:8px">
                          <a class="btn" href="@Url.Action("Visualizar","Chamado", new { id = c.Id })">Visualizar</a>
                      </div>
                  </article>
              }
          }
          else
          {
              <div class="muted">Você ainda não abriu chamados. <a class="btn" href="@Url.Action("Create","Chamado")">Abrir Chamado</a></div>
          }
        </div>
      </section>
    </main>
  </div>

  <script>
    // sidebar mobile toggle
    document.getElementById('toggleSidebar')?.addEventListener('click', ()=>{
      document.getElementById('sidebar').classList.toggle('open');
    });
    // close sidebar on outside click (mobile)
    document.addEventListener('click', (e)=>{
      const sb = document.getElementById('sidebar');
      const toggle = document.getElementById('toggleSidebar');
      if(!sb || !sb.classList.contains('open')) return;
      const target = e.target;
      if(!sb.contains(target) && target !== toggle) sb.classList.remove('open');
    });
  </script>
</body>
</html>
