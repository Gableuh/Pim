@model List<ProjetoTi.Models.Chamado>
@{
    ViewData["Title"] = "Dashboard";
    var usuarioNome = ViewData["NomeUsuario"]?.ToString() ?? "Usuário";
}

<!-- Dashboard do Usuário -->
<section id="view-recents" class="panel">
    <h3>Chamados Recentes</h3>
    <div class="grid">
        @foreach (var c in Model)
        {
            <div class="card">
                <h4>@c.Titulo</h4>
                <p class="muted">@c.Descricao</p>
                <p><strong>Status:</strong> @c.Status</p>
                <p><strong>Data:</strong> @c.DataAbertura.ToString("dd/MM/yyyy HH:mm")</p>
                <span class="badge @(c.Status.ToLower())">@c.Status</span>
                @if (c.Status != "Fechado")
                {
                    <a class="btn" href="@Url.Action("FecharChamado","Home", new { id = c.Id })">Fechar</a>
                }
            </div>
        }
    </div>
</section>

<section id="view-abrir" class="panel" style="display:none;">
    <h3>Abrir Novo Chamado</h3>
    <form method="post" action="@Url.Action("CriarChamado","Home")">
        <label>Título</label>
        <input type="text" name="titulo" required style="width:100%;padding:8px;border-radius:8px;border:1px solid #ccc;">
        <label>Descrição</label>
        <textarea name="descricao" rows="4" style="width:100%;padding:8px;border-radius:8px;border:1px solid #ccc;"></textarea>
        <button class="btn" type="submit">Enviar</button>
    </form>
</section>

<section id="view-meus" class="panel" style="display:none;">
    <h3>Meus Chamados</h3>
    <div class="grid">
        @foreach (var c in Model)
        {
            <div class="card">
                <h4>@c.Titulo</h4>
                <p class="muted">@c.Descricao</p>
                <p><strong>Status:</strong> @c.Status</p>
                <p><strong>Data:</strong> @c.DataAbertura.ToString("dd/MM/yyyy HH:mm")</p>
                <span class="badge @(c.Status.ToLower())">@c.Status</span>
                @if (c.Status != "Fechado")
                {
                    <a class="btn" href="@Url.Action("FecharChamado","Home", new { id = c.Id })">Fechar</a>
                }
            </div>
        }
    </div>
</section>

<script>
    // Navegação entre seções
    const navButtons = document.querySelectorAll('.nav-item');
    const views = {
        recents: document.getElementById('view-recents'),
        abrir: document.getElementById('view-abrir'),
        meus: document.getElementById('view-meus')
    };

    navButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            navButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const view = btn.dataset.view;
            Object.keys(views).forEach(k => views[k].style.display = (k === view) ? '' : 'none');
        });
    });
</script>
